<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>影音 on 记录点滴 - 分享</title><link>https://konghanghang.github.io/iminling-pages/categories/%E5%BD%B1%E9%9F%B3/</link><description>Recent content in 影音 on 记录点滴 - 分享</description><generator>Hugo -- gohugo.io</generator><language>zh-cn</language><copyright>iminling.com</copyright><lastBuildDate>Sun, 13 Oct 2024 02:04:10 +0000</lastBuildDate><atom:link href="https://konghanghang.github.io/iminling-pages/categories/%E5%BD%B1%E9%9F%B3/index.xml" rel="self" type="application/rss+xml"/><item><title>私人影院之rclone安装以及通过WebDav配置alist</title><link>https://konghanghang.github.io/iminling-pages/2024/install-rclone-and-configuration/</link><pubDate>Sun, 13 Oct 2024 02:04:10 +0000</pubDate><guid>https://konghanghang.github.io/iminling-pages/2024/install-rclone-and-configuration/</guid><description>&lt;p>上一篇文章介绍了对&lt;a class="link" href="https://www.iminling.com/2024/build-alist-server" title="私人影院之搭建自己的alist服务端并添加常见网盘"
target="_blank" rel="noopener"
>alist的安装&lt;/a>，本篇文章则来介绍一下rclone把alist里挂载的网盘再套娃挂载到本地磁盘，为后续emby直接读取本地的挂载文件做准备。那么接下来就开始折腾rclone.&lt;/p>
&lt;p>&lt;img src="https://www.iminling.com/wp-content/uploads/2024/10/FE27085E1D15A96BA8B9CD0E182FA3C9.png"
loading="lazy"
alt="rclone "
>&lt;/p>
&lt;h2 id="配置文件">配置文件
&lt;/h2>&lt;p>本文使用docker compose来进行安装，可以&lt;a class="link" href="https://hub.docker.com/r/rclone/rclone" target="_blank" rel="noopener"
>docker-hub&lt;/a>找到rclone的官方镜像地址，安装可以参考rclone的官方&lt;a class="link" href="https://rclone.org/install/#docker" target="_blank" rel="noopener"
>安装教程&lt;/a>。&lt;/p>
&lt;p>先要把rclone的配置文件给配置好，我这里只配置alist，所以直接给出配置文件内容方便大家快速使用:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">[alist]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">type = webdav
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">url = http://alist:5244/dav
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">vendor = other
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">user = admin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">pass = x9WN7skj6o7_fqjd4F
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>如上配置，&lt;/p>
&lt;p>[]中的名称自己定义一个，&lt;/p>
&lt;p>type固定为webdav，&lt;/p>
&lt;p>url为alist的webdav的url，url地址在&lt;a class="link" href="https://alist.nn.ci/zh/guide/webdav.html" target="_blank" rel="noopener"
>alist的文档&lt;/a>中也有说明，就是自己alist的ip+端口然后拼上/dav就可以了。&lt;/p>
&lt;p>vendor值为other&lt;/p>
&lt;p>user为自己的alist的用户名&lt;/p>
&lt;p>pass为自己的alist的用户名密码，但是密码需要进行加密才行，所以可以使用下边的命令来生成自己密码的密文，&lt;/p>
&lt;p>生成加密密码：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">docker run --rm -it \
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> rclone/rclone \
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> obscure [替换为具体的密码]
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>执行命令后就会生成一个你密码的密文，然后替换在配置文件中就可以了。&lt;/p>
&lt;p>经过上边处理配置文件就处理好了，可以命名为&lt;code>rclone.conf&lt;/code>，rclone的默认配置文件名就是这个，如果名字改动了，则需要在下边docker-compose配置文件的挂载时特殊配置。方便下边docker-compose文件使用。&lt;/p>
&lt;h2 id="docker-compose">docker compose
&lt;/h2>&lt;p>老规矩，所有的应用程序都使用docker compose安装，下边是docker-compose.yaml的完整配置：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">networks:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> mynet:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> external: true
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">services:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> rclone:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> image: rclone/rclone:latest
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> container_name: rclone
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> restart: always
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> cap_add:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - SYS_ADMIN
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> devices:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - /dev/fuse
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> security_opt:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - apparmor:unconfined
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> volumes:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - ./config:/config/rclone
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - /data/movies:/data:shared
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - /tmp:/tmp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> command: [
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &amp;#34;mount alist:/ /data --cache-dir /tmp --allow-other --vfs-cache-mode writes --allow-non-empty&amp;#34;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> networks:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - mynet
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>network网络配置我这里就不讲了，是我自己创建的一个桥接网络。&lt;/p>
&lt;p>这里主要说一下&lt;code>volumes&lt;/code>和&lt;code>command,&lt;/code> 其中&lt;code>cap_add&lt;/code>，&lt;code>devices&lt;/code>和&lt;code>security_opt&lt;/code>有兴趣的同学可以自己去研究他的含义，这里直接按照我给的配置文件就行了。&lt;/p>
&lt;p>volumes中&lt;code>/tmp&lt;/code>，临时文件存放在目录，在&lt;code>command&lt;/code>中指出了&lt;code>cache-dir&lt;/code>的位置，然后挂载到宿住机的/tmp.&lt;/p>
&lt;p>rclone的配置在容器的&lt;code>/config/rclone&lt;/code>目录下，我挂载到本地的config目录，把上边咱们生成的配置文件放在里边。&lt;/p>
&lt;p>&lt;code>/data/movies:/data&lt;/code>则是目录的配置，先是在&lt;code>command&lt;/code>中把咱们的远程alist中的/目录&lt;code>(alist:/)&lt;/code>和rclone容器中的&lt;code>/data&lt;/code>目录关联在一起，然后再通过volumes把容器中的&lt;code>/data&lt;/code>挂载在宿主机的&lt;code>/data/movies&lt;/code>下。通过这个目录挂载，咱们就可以在宿主机下&lt;code>/data/movies&lt;/code>中浏览alist中所有挂载的文件信息，为后边&lt;code>emby&lt;/code>添加影视库做准备。&lt;/p>
&lt;h2 id="容器启动">容器启动
&lt;/h2>&lt;p>上边的配置信息完成后，文件放到对应的目录下，我这边的目录结构如下：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">root@docker:~/rclone# tree
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">├── config
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">│ └── rclone.conf
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">└── docker-compose.yaml
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>然后在rclone目录下执行&lt;code>docker compose up -d&lt;/code>启动容器就可以了。&lt;/p>
&lt;p>如果配置没问题应该就可以在宿主机&lt;code>/data/movies&lt;/code>目录下看到alist中的网盘和所有文件了。&lt;/p>
&lt;p>以上就是折腾rclone和alist的过程，把alist挂载到本地，想本地目录文件一样来进行浏览，方便后续emby进行影视库的添加。&lt;/p></description></item><item><title>私人影院之搭建自己的alist服务端并添加常见网盘</title><link>https://konghanghang.github.io/iminling-pages/2024/build-alist-server/</link><pubDate>Sat, 21 Sep 2024 09:56:03 +0000</pubDate><guid>https://konghanghang.github.io/iminling-pages/2024/build-alist-server/</guid><description>&lt;p>前段时间写了一篇如何&lt;a class="link" href="https://www.iminling.com/2024/how-to-build-xiaoya-alist-and-use" title="搭建属于自己的影视小站：小雅Alist安装及使用"
target="_blank" rel="noopener"
>搭建小雅alist&lt;/a>的文章，使用小雅的媒体库来进行观影，但是这种有一个问题就是小雅的库更新的不是很快，而且如果我想在电视上观看比较麻烦，就算搭配emby,也无法避免资源更新慢的问题。所以就想着使用自己的网盘配合自己搭建的alist服务端，来进行资源快速入库，方便自己快速观看。那么接下来就详细说明一下自己的搭建过程。&lt;/p>
&lt;h2 id="alist服务端">alist服务端
&lt;/h2>&lt;p>我这里使用&lt;code>docker compose&lt;/code>来搭建&lt;code>alist server&lt;/code>,alist提供了两个版本的镜像，一个是普通的版本，一个是带aria2下载的版本，根据自己的需求进行安装，安装文档参考&lt;a class="link" href="https://alist.nn.ci/zh/guide/install/docker.html" target="_blank" rel="noopener"
>官方文档&lt;/a>。&lt;/p>
&lt;p>我的docker-compose.yaml如下：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">networks:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> mynet:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> external: true
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">services:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> alist:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> image: xhofe/alist-aria2:latest
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> container_name: alist
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> restart: unless-stopped
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> volumes:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - ./data:/opt/alist/data
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> networks:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - mynet
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ports:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - 15244:5244
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> extra_hosts:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - host.docker.internal:host-gateway
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> environment:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - PUID=0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - PGID=0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - UMASK=022
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - TZ=Asia/Shanghai
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>我的目录分配如下：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">├── data
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">└── docker-compose.yaml
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>整体配置是比较简单的，我使用了自己的网络&lt;code>mynet&lt;/code>，而不是让docker自建一个网络，方便后续容器之间的项目访问。&lt;/p>
&lt;p>按照上边配置好后直接&lt;code>docker compose up -d&lt;/code>运行起来容器。之后通过访问ip:15244(我这里映射到主机的15244端口了)，默认admin用户和密码，进行登录并修改密码。容器启动成功，alist的服务端搭建就算完成了。&lt;/p>
&lt;h2 id="网盘添加">网盘添加
&lt;/h2>&lt;p>我这里主要添加三种类型，天翼云盘，115网盘，本地smb，下边就看一下每种网盘是需要怎么来添加。&lt;/p>
&lt;h3 id="天翼云盘">天翼云盘
&lt;/h3>&lt;p>我家里使用的是电信的宽带，送了天翼网盘的会员，个人和家庭分别是4TB，整体也不算少。&lt;/p>
&lt;p>进入到alist的管理界面&lt;/p>
&lt;p>&lt;img src="https://www.iminling.com/wp-content/uploads/2024/09/12346FDFD92375CFACA05F8AE99636F2.png"
loading="lazy"
alt="alist disk"
>&lt;/p>
&lt;p>点击存储-添加,然后选择&lt;code>天翼云盘客户端&lt;/code>(官方建议的类型)。然后就可以看到很多选项需要填写，具体的填写操作步骤参考&lt;a class="link" href="https://alist.nn.ci/zh/guide/drivers/189.html" target="_blank" rel="noopener"
>官方文档&lt;/a>。&lt;/p>
&lt;p>&lt;img src="https://www.iminling.com/wp-content/uploads/2024/09/643C95E88930EA3944C1185A24EBB379.png"
loading="lazy"
alt="alist add 189"
>&lt;/p>
&lt;p>挂载路径是最终显示在alist主页的名称，需要唯一。&lt;/p>
&lt;p>缓存过期时间根据自己的需求来定义，比如我添加了一个文件想要快一点能刷新出来，那么我就定义短一点(比如1分钟)，这个根据自己需求来定。&lt;/p>
&lt;p>WebDAV策略建议都使用302重定向，这样子在通过WebDAV访问alist服务端的内容的时候，实际上会重定向到网盘内真实的路径，等于直接访问网盘。&lt;/p>
&lt;p>&lt;img src="https://www.iminling.com/wp-content/uploads/2024/09/35D3FFFECD6E46B2E2B13B4C3082C901.png"
loading="lazy"
alt="alist add 189"
>&lt;/p>
&lt;p>启用签名选项如果后续是需要配合emby实现302播放，&lt;strong>一定要打开，一定要打开，一定要打开&lt;/strong>。&lt;/p>
&lt;p>用户名就是天翼云盘登录的手机号。&lt;/p>
&lt;p>密码是天翼云盘登录的密码。&lt;/p>
&lt;p>根文件的id根据自己需求，如果只是想把网盘内的某一个目录添加到alist中，那就按照&lt;a class="link" href="https://alist.nn.ci/zh/guide/drivers/189.html" target="_blank" rel="noopener"
>官方文档&lt;/a>里的方法找到对应的文件夹id。&lt;/p>
&lt;p>类型有&lt;code>家庭云&lt;/code>和&lt;code>个人云&lt;/code>，&lt;code>family id&lt;/code>在是选择&lt;code>家庭云&lt;/code>的时候需要填写，官网里都有介绍。我这里就是&lt;code>家庭云&lt;/code>。&lt;/p>
&lt;p>基本上述搞定就可以添加成功了。&lt;/p>
&lt;h3 id="115网盘">115网盘
&lt;/h3>&lt;p>基本和天翼云盘添加流程差不多，驱动类型选择&lt;code>115网盘&lt;/code>,挂载路径、缓存过期时间、WebDAV策略、启用签名四个选项和天翼云盘意向逻辑，进行处理就行了。有不明白的可以参考&lt;a class="link" href="https://alist.nn.ci/zh/guide/drivers/115.html" target="_blank" rel="noopener"
>官方文档&lt;/a>。&lt;/p>
&lt;p>&lt;img src="https://www.iminling.com/wp-content/uploads/2024/09/3D235946E3F03628AFC314D9E2018E98.png"
loading="lazy"
alt="alist add 115"
>&lt;/p>
&lt;p>cookie和Qrcode二选一，&lt;a class="link" href="https://alist.nn.ci/zh/guide/drivers/115.html#_1-qrcode-%E6%89%AB%E7%A0%81%E6%96%B9%E5%BC%8F%E7%99%BB%E5%BD%95" target="_blank" rel="noopener"
>官方文档&lt;/a>也有详细的介绍，包括根文件夹ID，都有详细的介绍，参考文档就可以了。感觉Qrcode会简单一点。我是直接使用的抓包软件抓的应用的cookie。这里有一个事项需要注意一下，如果使用了手机端软件，后续在网页登录的时候最好选择用手机扫码登录，要不然可能会把手机应用端挤掉导致cookie失效。&lt;/p>
&lt;h3 id="smb添加">SMB添加
&lt;/h3>&lt;p>有些文件没有放在网盘，而是放在自己本地或者放在本地nas中，比如我上篇文档也介绍了&lt;a class="link" href="https://www.iminling.com/2024/pve-install-nas" title="Proxmox VE(PVE)8.0安装黑群晖NAS并直通硬盘"
target="_blank" rel="noopener"
>如何安装黑群晖&lt;/a>，这样子想要在alist中把nas中的资源添加进去，就需要使用到SMB一些了，nas中是有开启这个功能的。&lt;/p>
&lt;p>&lt;img src="https://www.iminling.com/wp-content/uploads/2024/09/6BFD9B721FB31AFA57FF87D6CF084938.png"
loading="lazy"
alt="alist add smb nas"
>&lt;/p>
&lt;p>添加驱动类型选择&lt;code>SMB&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://www.iminling.com/wp-content/uploads/2024/09/08EBBBA8CC68A83179643B66EBDB09EE.png"
loading="lazy"
alt="alist add smb nas"
>&lt;/p>
&lt;p>smb是本地文件，启用签名就可以不用开了。地址、用户名、密码和分享名称(smb中的目录)根据自己的需求填写就可以了。&lt;/p>
&lt;h2 id="总结">总结
&lt;/h2>&lt;p>我这里介绍了三种网盘的添加方式，其他的网盘也都大同小异，比如添加阿里云盘等。那么搭建alist服务端并添加网盘，就介绍到这里。希望可以帮到大家。&lt;/p>
&lt;p>接下来还会介绍利用rclone挂载alist，然后让emby来使用并实现302播放。&lt;/p></description></item><item><title>Proxmox VE(PVE)8.0安装黑群晖NAS并直通硬盘</title><link>https://konghanghang.github.io/iminling-pages/2024/pve-install-nas/</link><pubDate>Mon, 16 Sep 2024 10:00:29 +0000</pubDate><guid>https://konghanghang.github.io/iminling-pages/2024/pve-install-nas/</guid><description>&lt;p>前段时间通过pve安装&lt;a class="link" href="https://www.iminling.com/2024/pve-install-ikuai" title="Proxmox VE(PVE)8.0安装爱快ikuai虚拟机并直通网卡"
target="_blank" rel="noopener"
>ikuai&lt;/a>,&lt;a class="link" href="https://www.iminling.com/2024/pve-install-openwrt" title="Proxmox VE(PVE)8.0安装Openwrt实现旁路由模式"
target="_blank" rel="noopener"
>openwrt&lt;/a>以及&lt;a class="link" href="https://www.iminling.com/2024/pve-use-ct-template-install-lxc-docker" title="Proxmox VE(PVE)8.0使用CT模板创建LXC版docker服务"
target="_blank" rel="noopener"
>使用lxc安装了docker&lt;/a>,之后就一直稳定使用，J4125上有一个2T的硬盘，于是就想着折腾一下在上边安装一下黑群晖，体验一下nas系统。于是就又开始了折腾之路，又学习了很多知识。下边就记录一下我折腾的过程。&lt;/p>
&lt;h2 id="准备">准备
&lt;/h2>&lt;p>其实在开始装nas之前我看了很多教程，里边只是提供安装过程，并提供对应的安装包。说实在的，虽然很贴心，但是每个人的主机不尽相同，适合他的nas包不一定适合我，那么自己应该选择什么nas包呢？他们基本都没有说明，但是基本都是安装DS918+。于是在b站找到了一个&lt;a class="link" href="https://www.bilibili.com/video/BV1KE421N7mN" target="_blank" rel="noopener"
>版本选择教程&lt;/a>，腾讯文档地址：&lt;a class="link" href="https://docs.qq.com/sheet/DYXhtcVRPaXRCY0tv" target="_blank" rel="noopener"
>RR型号列表&lt;/a>。然后又看了rr安装，使用rr安装很方便：&lt;a class="link" href="https://github.com/RROrg/rr" target="_blank" rel="noopener"
>RR地址&lt;/a>。&lt;/p>
&lt;p>直接下载一个最新RR的镜像就可以了。至于nas的版本，两个选择，DS918+和SA6400，两个版本都是视频中推荐的版本，如果cpu是10代以后选择SA6400，如果10代以前则两个都可以。&lt;/p>
&lt;h2 id="安装">安装
&lt;/h2>&lt;h3 id="新建虚拟机">新建虚拟机
&lt;/h3>&lt;p>下载好镜像后就需要在pve中进行新建虚拟机了。步骤和openwrt差不多。&lt;/p>
&lt;p>&lt;img src="https://www.iminling.com/wp-content/uploads/2024/09/604C610F0F9AB44B9C0176E5C7753C51.png"
loading="lazy"
alt="new vm"
>&lt;/p>
&lt;p>常规选项：只需要填写一个名称就可以了。&lt;/p>
&lt;p>操作系统：选择&lt;code>不使用任何介质&lt;/code>。&lt;/p>
&lt;p>系统：只需要将机型设置为&lt;code>q35&lt;/code>，其他默认。&lt;/p>
&lt;p>磁盘：直接把磁盘删除。&lt;/p>
&lt;p>CPU：&lt;code>核心数&lt;/code>根据自己的cpu设置，我这里给4.另外&lt;code>类别&lt;/code>下拉到最后，选择&lt;code>host&lt;/code>模式。&lt;/p>
&lt;p>内存：内存给2-4GB都可以，我这里给4G.&lt;/p>
&lt;p>网络：默认。模型为:VirtIo(半虚拟化)。&lt;/p>
&lt;p>然后就是确认刚才填的信息，确认就可以了。&lt;/p>
&lt;p>经过上边已经创建好了一个虚拟机，下边还需要上传刚才下载的rr镜像。&lt;/p>
&lt;h3 id="镜像上传">镜像上传
&lt;/h3>&lt;p>如图的位置进行上传。&lt;/p>
&lt;p>&lt;img src="https://www.iminling.com/wp-content/uploads/2024/03/BC97614C54342FD608F4DC6371CAC5A2.png"
loading="lazy"
alt="upload iso"
>&lt;/p>
&lt;p>接下来在shell中使用命令将黑群晖的引导文件rr导入到创建好的DSM虚拟机，进入到&lt;code>pve系统的shell&lt;/code>中执行。&lt;/p>
&lt;p>命令如下：&lt;code>qm importdisk 编号 /var/lib/vz/template/iso/rr.img local-lvm&lt;/code> , 其中编号为刚创建的虚拟机编号，rr.img的镜像上传路径基本不会有不同，基本都是在&lt;code>/var/lib/vz/template/iso&lt;/code>目录下 再加上镜像名称，我这里就是&lt;code>rr.img&lt;/code>。&lt;/p>
&lt;p>我的完整命令如下：&lt;code>qm importdisk 104 /var/lib/vz/template/iso/rr.img local-lvm&lt;/code>。执行成功后可以在nas虚拟机的硬件里看到一个未使用的磁盘，双击可添加磁盘：&lt;/p>
&lt;p>总线设备选sata，磁盘映像默认就是刚看到的那个未使用的磁盘。其他的默认就可以了。&lt;/p>
&lt;h3 id="硬盘直通">硬盘直通
&lt;/h3>&lt;p>经过上边的设置基本就可以了，此时还需要给nas添加一个磁盘。在pve的shell中通过命令找到我的固态盘ls -l /dev/disk/by-id/：&lt;/p>
&lt;p>&lt;img src="https://www.iminling.com/wp-content/uploads/2024/09/A2C2455053EAB75DD05961B46B8B8144.png"
loading="lazy"
alt="disk"
>&lt;/p>
&lt;p>可以看到ata开头的ZHITAI就是我的固态盘了。复制完整的名称：ata-ZHITAI_SC001_XT_2000GB_ZTB502TAB2404507RX。&lt;/p>
&lt;p>然后通过命令直通给nas，set后边就是虚拟机的编号，我这里是103，后边&amp;ndash;satax 根据自己的定义，刚添加的引导盘占了sata0,所以我这里就使用sata1 后边就是完整的磁盘路径 /dev/disk/by-id/拼上的判断完整名。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">root@pve:~# qm set 103 --sata1 /dev/disk/by-id/ata-ZHITAI_SC001_XT_2000GB_ZTB502TAB2404507RX
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">update VM 103: -sata1 /dev/disk/by-id/ata-ZHITAI_SC001_XT_2000GB_ZTB502TAB2404507RX
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>执行完成后就可以看到新添加的磁盘了：
&lt;img src="https://www.iminling.com/wp-content/uploads/2024/09/C9EC9466FC5A73F50BD85C622D9B7EB7.png"
loading="lazy"
alt="nas vm"
>&lt;/p>
&lt;p>然后修改启动顺序后就可以启动了。&lt;/p>
&lt;p>把sata0设置为第一位：&lt;/p>
&lt;p>&lt;img src="https://www.iminling.com/wp-content/uploads/2024/09/6BA2533C829AF79C9E75BBCDEBD11983.png"
loading="lazy"
alt="nas "
>&lt;/p>
&lt;p>启动成功后，在控制台中可以看到提示，会让访问一个ip:7681的网址去进行初次设置。&lt;/p>
&lt;h3 id="引导编译">引导编译
&lt;/h3>&lt;p>访问7681端口的那个网址&lt;/p>
&lt;p>先进行语言设置，选择Choose a language，找到zh-CN,切换语言为中文。&lt;/p>
&lt;p>型号选择：我这里选择SA6400&lt;/p>
&lt;p>版本选择：我这里选择DSM7.2&lt;/p>
&lt;p>弹出的版本页面，点击URL会自动下载当前引导的系统文件（建议使用此方式下载，避免在群晖官网下载错系统），下载好的系统文件后缀为pat，然后点击确认。下边初始化会用到。&lt;/p>
&lt;p>然后选择编译引导。&lt;/p>
&lt;p>只需要等待。&lt;/p>
&lt;p>编译好引导后会自动跳转到主菜单的启动选项，直接点击启动即可。&lt;/p>
&lt;p>正常开机后，可以再次在&lt;code>控制台&lt;/code>看到让访问&lt;code>ip:5000&lt;/code>的端口，此时说明安装已经ok了。&lt;/p>
&lt;h2 id="nas初始化">NAS初始化
&lt;/h2>&lt;p>接下来就是访问ip:5000来进行NAS的初始化,我这里的ip是192.1681.42:5000&lt;/p>
&lt;p>&lt;img src="https://www.iminling.com/wp-content/uploads/2024/09/592F95F353A14370E1FF9074D6FDFEA0.png"
loading="lazy"
alt="sa6400 1"
>&lt;/p>
&lt;p>安装。&lt;/p>
&lt;p>&lt;img src="https://www.iminling.com/wp-content/uploads/2024/09/49DADB749C25BD32C29BE8EB53F3CA20.png"
loading="lazy"
alt="nas pat"
>&lt;/p>
&lt;p>选择&lt;code>引导编译阶段&lt;/code>下载的pat文件。&lt;/p>
&lt;p>&lt;img src="https://www.iminling.com/wp-content/uploads/2024/09/5B271AB0441EC5953E419CA1D3BD98AD.png"
loading="lazy"
alt="sa6400 clean disk"
>&lt;/p>
&lt;p>提示会删除硬盘数据，继续进行确认。&lt;/p>
&lt;p>&lt;img src="https://www.iminling.com/wp-content/uploads/2024/09/0FE9CABE0F4CA60A3B935A85DC221EE4.png"
loading="lazy"
alt="sa6400 install"
>&lt;/p>
&lt;p>等待安装。安装后就是重启，提示大概需要10分钟，实际上我等了3分钟就可以了。&lt;/p>
&lt;p>&lt;img src="https://www.iminling.com/wp-content/uploads/2024/09/5AD9C906151D6CBF02C59A81F8A8186A.png"
loading="lazy"
alt="sa6400 reboot"
>&lt;/p>
&lt;p>重启完成后就会提示安装组件：&lt;/p>
&lt;p>&lt;img src="https://www.iminling.com/wp-content/uploads/2024/09/E215646EE5D97151C416C9479AA3B453.png"
loading="lazy"
alt="sa6400 install"
>&lt;/p>
&lt;p>套件安装完成后进入安装引导：&lt;/p>
&lt;p>&lt;img src="https://www.iminling.com/wp-content/uploads/2024/09/6B22933AFE0F4B3EC3E3F60BF343449B.png"
loading="lazy"
alt="sa6400 install"
>&lt;/p>
&lt;p>进入用户名和密码设置：&lt;/p>
&lt;p>&lt;img src="https://www.iminling.com/wp-content/uploads/2024/09/4ECBD6C45D45FC7B2CA25112E5709433.png"
loading="lazy"
alt="sa6400 username setting"
>&lt;/p>
&lt;p>接下来的更新就不需要了自动安装了：&lt;/p>
&lt;p>&lt;img src="https://www.iminling.com/wp-content/uploads/2024/09/CA6984342AD234286EC09ACB05D7D124.png"
loading="lazy"
alt="sa6400 udpate options"
>&lt;/p>
&lt;p>账号创建跳过：&lt;/p>
&lt;p>&lt;img src="https://www.iminling.com/wp-content/uploads/2024/09/DE2ED5DABB970424565042BA51AFBECA.png"
loading="lazy"
alt="sa6400 account"
>&lt;/p>
&lt;p>用户体验不勾选，提交：&lt;/p>
&lt;p>&lt;img src="https://www.iminling.com/wp-content/uploads/2024/09/6CB3DAD099AD85BF0C5B38556171A378.png"
loading="lazy"
alt="sa6400 install"
>&lt;/p>
&lt;p>经过上边的一系列设置，终于来到了nas的桌面中。&lt;/p>
&lt;h3 id="桌面设置">桌面设置
&lt;/h3>&lt;p>群晖套件：不用了，谢谢。&lt;/p>
&lt;p>&lt;img src="https://www.iminling.com/wp-content/uploads/2024/09/619B1456828D5B4ABDE474DCA9FA912A.png"
loading="lazy"
alt="synology setting"
>&lt;/p>
&lt;p>双重2FA不开启：&lt;/p>
&lt;p>&lt;img src="https://www.iminling.com/wp-content/uploads/2024/09/3B72584B496288EDBEE9D40F5CCF434F.png"
loading="lazy"
alt="synology 2fa"
>&lt;/p>
&lt;p>下一步账户保护不开启。&lt;/p>
&lt;p>终于都设置完了。。。&lt;/p>
&lt;h3 id="磁盘设置">磁盘设置
&lt;/h3>&lt;p>经过上边的设置，终于提示要设置磁盘了。&lt;/p>
&lt;p>&lt;img src="https://www.iminling.com/wp-content/uploads/2024/09/FA77EE697520348E4EB0A53A7315E90C.png"
loading="lazy"
alt="sa6400 disk setting"
>&lt;/p>
&lt;p>点击开始进行设置：&lt;/p>
&lt;p>&lt;img src="https://www.iminling.com/wp-content/uploads/2024/09/29DA9906BF517DAD5CD40C564A4C1FDF.png"
loading="lazy"
alt="sa6400 raid"
>&lt;/p>
&lt;p>raid类别根据自己的需要选择，我这里 就一个硬盘，直接选择basic类型。继续下一步,选择硬盘，我这里需要一个硬盘：
&lt;img src="https://www.iminling.com/wp-content/uploads/2024/09/0566CFC1A0979B154AB4A32DB2A11DAE.png"
loading="lazy"
alt="sa6400 disk select"
>&lt;/p>
&lt;p>继续下一步，跳过硬盘检查：&lt;/p>
&lt;p>&lt;img src="https://www.iminling.com/wp-content/uploads/2024/09/322E5645680C559C7DA307C31005E93A.png"
loading="lazy"
alt="sa6400 disk check"
>&lt;/p>
&lt;p>继续下一步配置磁盘容量：&lt;/p>
&lt;p>&lt;img src="https://www.iminling.com/wp-content/uploads/2024/09/C7B2995636E2C4F9EF0686AC8325858D.png"
loading="lazy"
alt="sa6400 disk cap"
>&lt;/p>
&lt;p>直接最大化，整个都分配给nas，继续下一步文件系统：&lt;/p>
&lt;p>&lt;img src="https://www.iminling.com/wp-content/uploads/2024/09/35A3D7B70E1BB725A8097A9E22963569.png"
loading="lazy"
alt="sa6400 disk file type"
>&lt;/p>
&lt;p>这里我就选择他推荐的，继续下一步配置加密：&lt;/p>
&lt;p>&lt;img src="https://www.iminling.com/wp-content/uploads/2024/09/3315AE268C487E5A8E1677C552A44706.png"
loading="lazy"
alt="sa6400 file encrypt"
>&lt;/p>
&lt;p>我这里不加密，默认，继续下一步，对刚才的配置在进行概览：&lt;/p>
&lt;p>&lt;img src="https://www.iminling.com/wp-content/uploads/2024/09/F7CDBAB9BA5852495DCB9108238CEF4B.png"
loading="lazy"
alt="sa6400 configuration check"
>&lt;/p>
&lt;p>配置无问题应用就可以了。终于整个nas都配置后了。&lt;/p>
&lt;p>最后再上一个桌面显示的图片：&lt;/p>
&lt;p>&lt;img src="https://www.iminling.com/wp-content/uploads/2024/09/EB7EF2C081536198F30240284EFD2D04.png"
loading="lazy"
alt="sa6400 desktop"
>&lt;/p>
&lt;p>以上就是pve安装黑群晖的折腾记录。&lt;/p></description></item><item><title>docker搭建aliyunpan-sync时实增量同步阿里云盘文件</title><link>https://konghanghang.github.io/iminling-pages/2024/docker-deploy-aliyunpan-sync/</link><pubDate>Sat, 06 Jul 2024 03:11:29 +0000</pubDate><guid>https://konghanghang.github.io/iminling-pages/2024/docker-deploy-aliyunpan-sync/</guid><description>&lt;p>在前边的文章中介绍了如何快速的搭建&lt;a class="link" href="https://www.iminling.com/2024/04/20/586.html" title="搭建属于自己的影视小站：小雅Alist安装及使用"
target="_blank" rel="noopener"
>小雅alist&lt;/a>来满足大家的观影需求，但是有一些剧小雅更新没那么及时，这时候就需要大家八仙过海了。如何及时找到自己要观看的剧，并成功观看呢？下边就带着大家一起使用&lt;a class="link" href="https://github.com/tickstep/aliyunpan" target="_blank" rel="noopener"
>aliyunpan-sync&lt;/a>工具来同步阿里云盘的数据。&lt;/p>
&lt;h2 id="网盘选择">网盘选择
&lt;/h2>&lt;p>这里为什么要选择阿里云盘呢？因为阿里网盘资源比较多，更新也比较快，然后网上也找了同步阿里云盘的同步工具：&lt;a class="link" href="https://github.com/tickstep/aliyunpan" target="_blank" rel="noopener"
>aliyunpan-sync&lt;/a>，理论上115，百度云，夸克这些网盘也都是ok的，主要是把文件同步到本地，具体的网盘的同步工具就需要大家自己去找了。我这里只带着大家实现阿里云盘的同步。另外推荐给大家一个电报的阿里云盘的资源通知群，资源更新还是挺及时的：&lt;a class="link" href="https://t.me/yunpanpan" title="阿里云盘telegram群组"
target="_blank" rel="noopener"
>https://t.me/yunpanpan&lt;/a>。&lt;/p>
&lt;h2 id="安装aliyunpan-sync">安装aliyunpan-sync
&lt;/h2>&lt;p>我这里使用的是docker compose进行的安装，如果还没有安装docker的同学可以参考的我的文章把docker 给安装一下：&lt;a class="link" href="https://www.iminling.com/2023/06/10/164.html" title="docker安装"
target="_blank" rel="noopener"
>docker安装&lt;/a>。&lt;/p>
&lt;h3 id="获取阿里云盘token">获取阿里云盘token
&lt;/h3>&lt;p>要想从阿里云盘里下载文件，肯定是需要先登录阿里云盘才能进行数据同步，如何登录阿里云盘aliyunpan-sync工具里也有具体的说明：&lt;a class="link" href="https://github.com/tickstep/aliyunpan/blob/main/docs/manual.md#%E7%99%BB%E5%BD%95%E9%98%BF%E9%87%8C%E4%BA%91%E7%9B%98%E5%B8%90%E5%8F%B7" target="_blank" rel="noopener"
>登录阿里云盘&lt;/a>，需要先在&lt;a class="link" href="https://github.com/tickstep/aliyunpan/releases" target="_blank" rel="noopener"
>release&lt;/a>页面下载一个对应系统的release，我的操作系统是mac m1芯片我就下载arm那个&lt;/p>
&lt;p>&lt;img src="https://www.iminling.com/wp-content/uploads/2024/07/FAEE60916F633EC24FFD16E75F5AAB73.png"
loading="lazy"
alt="aliyunpan sync release"
>&lt;/p>
&lt;p>然后对文件进行解压，使用终端进入到对应的目录里，看到有一个&lt;code>aliyunpan&lt;/code>的文件，执行这个文件获取登录链接，然后在网页端进行扫码登录就可以了。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># k @ Mac-mini in ~/Downloads/aliyunpan-v0.3.2-darwin-macos-arm64 [10:03:26]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">$&lt;/span> &lt;span class="n">ls&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">README&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">md&lt;/span> &lt;span class="n">manual&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">md&lt;/span> &lt;span class="n">sync&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">sh&lt;/span> &lt;span class="n">webdav&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">sh&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">aliyunpan&lt;/span> &lt;span class="n">plugin&lt;/span> &lt;span class="n">sync_drive&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">aliyunpan_config&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">json&lt;/span> &lt;span class="n">sync&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">bat&lt;/span> &lt;span class="n">webdav&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">bat&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># k @ Mac-mini in ~/Downloads/aliyunpan-v0.3.2-darwin-macos-arm64 [10:03:28]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">$&lt;/span> &lt;span class="n">aliyunpan&lt;/span> &lt;span class="n">login&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">zsh&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">command&lt;/span> &lt;span class="ow">not&lt;/span> &lt;span class="n">found&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">aliyunpan&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># k @ Mac-mini in ~/Downloads/aliyunpan-v0.3.2-darwin-macos-arm64 [10:03:42] C:127&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">$&lt;/span> &lt;span class="o">./&lt;/span>&lt;span class="n">aliyunpan&lt;/span> &lt;span class="n">login&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">请在浏览器打开以下链接进行登录，链接有效时间为&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="err">分钟。&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">注意：你需要进行一次授权一次扫码的两次登录。&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">https&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">//&lt;/span>&lt;span class="n">openapi&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">alipan&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">com&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">oauth&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">authorize&lt;/span>&lt;span class="err">?&lt;/span>&lt;span class="n">client_id&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">cf9f70e8fc6143031375&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">redirect_uri&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">https&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="n">A&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="n">F&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="n">Fapi&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">tickstep&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">com&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="n">Fauth&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="n">Ftickstep&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="n">Faliyunpan&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="n">Ftoken&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="n">Fopenapi&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="n">F0bd327267c41f7b2fcadf927&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="n">Fauth2&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">scope&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">user&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="n">base&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">file&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="n">all&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="n">read&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">file&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="n">all&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="n">write&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">请在浏览器里面完成扫码登录，然后再按&lt;/span>&lt;span class="n">Enter键继续&lt;/span>&lt;span class="o">...&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>打开url就需要使用手机端的阿里云盘进行扫码登录，提示进行授权：&lt;/p>
&lt;p>&lt;img src="https://www.iminling.com/wp-content/uploads/2024/07/2F4D63F1408D9F02A15CC4F6E7533A1B.png"
loading="lazy"
alt="aliyunpan authority"
>&lt;/p>
&lt;p>根据需要选择授权范围，我这里把&lt;code>备份盘&lt;/code>和&lt;code>资源库&lt;/code>都进行授权，其实就是整个阿里云盘这个工具都可以访问。然后就是回到终端看到具体的token。保存好这个token.&lt;/p>
&lt;h3 id="docker镜像启动">docker镜像启动
&lt;/h3>&lt;p>我这里使用的是docker compose来进行安装的，我的文件目录如下：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="o">$&lt;/span> &lt;span class="n">tree&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">├──&lt;/span> &lt;span class="n">config&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">├──&lt;/span> &lt;span class="n">docker&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">compose&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">yaml&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">├──&lt;/span> &lt;span class="n">js&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">│&lt;/span> &lt;span class="err">├──&lt;/span> &lt;span class="n">download_handler&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">js&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">sample&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">│&lt;/span> &lt;span class="err">├──&lt;/span> &lt;span class="n">sync_handler&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">js&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">│&lt;/span> &lt;span class="err">├──&lt;/span> &lt;span class="n">sync_handler&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">js&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">sample&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">│&lt;/span> &lt;span class="err">├──&lt;/span> &lt;span class="n">token_handler&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">js&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">│&lt;/span> &lt;span class="err">├──&lt;/span> &lt;span class="n">token_handler&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">js&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">sample&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">│&lt;/span> &lt;span class="err">└──&lt;/span> &lt;span class="n">upload_handler&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">js&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">sample&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">└──&lt;/span> &lt;span class="n">sync_drive&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>config目录是用来挂在配置文件的，等下token是要填在这个目录下的&lt;code>aliyunpan_config.json&lt;/code>文件里的。&lt;/p>
&lt;p>js目录是用来做一些脚本处理，用来控制什么文件可以上传，什么文件可以下载，以及进行一些通知操作的。&lt;/p>
&lt;p>sync_drive是保存数据库的信息，用来记录同步的一些信息，即使容器销毁，同步数据库还可以用于以后使用。&lt;/p>
&lt;p>具体的docker-compose.yaml文件内容如下：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;span class="lnt">41
&lt;/span>&lt;span class="lnt">42
&lt;/span>&lt;span class="lnt">43
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">version&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s1">&amp;#39;3&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">services&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">sync&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">image&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">tickstep&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">aliyunpan&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">sync&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="n">v0&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">3.2&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">container_name&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">aliyunpan&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">sync&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">restart&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">unless&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">stopped&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">volumes&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># （必须）映射的本地目录&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">-&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">data&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">webdav&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">data&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">home&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">app&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">data&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="n">rw&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># （可选）可以指定JS插件sync_handler.js用于过滤文件，详见插件说明&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">#- ./config/sync_handler.js:/home/app/config/plugin/js/sync_handler.js&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">-&lt;/span> &lt;span class="o">./&lt;/span>&lt;span class="n">js&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">home&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">app&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">config&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">plugin&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">js&lt;/span>&lt;span class="o">/&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># （推荐）挂载sync_drive同步数据库到本地，这样即使容器销毁，同步数据库还可以用于以后使用&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">-&lt;/span> &lt;span class="o">./&lt;/span>&lt;span class="n">sync_drive&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">home&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">app&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">config&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">sync_drive&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># （必须）映射token凭据文件&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">-&lt;/span> &lt;span class="o">./&lt;/span>&lt;span class="n">config&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">aliyunpan_config&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">json&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">home&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">app&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">config&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">aliyunpan_config&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">json&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">extra_hosts&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">-&lt;/span> &lt;span class="n">host&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">docker&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">internal&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="n">host&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">gateway&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">environment&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># 时区，东8区&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">-&lt;/span> &lt;span class="n">TZ&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">Asia&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">Shanghai&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># 下载文件并发数&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">-&lt;/span> &lt;span class="n">ALIYUNPAN_DOWNLOAD_PARALLEL&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">2&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># 上传文件并发数&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">-&lt;/span> &lt;span class="n">ALIYUNPAN_UPLOAD_PARALLEL&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">2&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># 下载数据块大小，单位为KB，默认为10240KB，建议范围1024KB~10240KB&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">-&lt;/span> &lt;span class="n">ALIYUNPAN_DOWNLOAD_BLOCK_SIZE&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">1024&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># 上传数据块大小，单位为KB，默认为10240KB，建议范围1024KB~10240KB&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">-&lt;/span> &lt;span class="n">ALIYUNPAN_UPLOAD_BLOCK_SIZE&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">10240&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># 指定网盘文件夹作为备份目标目录，不要指定根目录&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">-&lt;/span> &lt;span class="n">ALIYUNPAN_PAN_DIR&lt;/span>&lt;span class="o">=/&lt;/span>&lt;span class="err">来自分享&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># 备份模式：upload(备份本地文件到云盘), download(备份云盘文件到本地)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">-&lt;/span> &lt;span class="n">ALIYUNPAN_SYNC_MODE&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">download&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># 备份策略: exclusive(排他备份文件，目标目录多余的文件会被删除),increment(增量备份文件，目标目录多余的文件不会被删除)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">#- ALIYUNPAN_SYNC_POLICY=increment&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># 备份周期, 支持两种: infinity(永久循环备份),onetime(只运行一次备份)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">#- ALIYUNPAN_SYNC_CYCLE=infinity&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># 网盘：backup(备份盘), resource(资源盘)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">-&lt;/span> &lt;span class="n">ALIYUNPAN_SYNC_DRIVE&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">resource&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># 是否显示文件备份过程日志，true-显示，false-不显示&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">-&lt;/span> &lt;span class="n">ALIYUNPAN_SYNC_LOG&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="bp">true&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># 本地文件修改检测延迟间隔，单位秒。如果本地文件会被频繁修改，例如录制视频文件，配置好该时间可以避免上传未录制好的文件&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">-&lt;/span> &lt;span class="n">ALIYUNPAN_LOCAL_DELAY_TIME&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">60&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>重点说一下上边的四个配置：&lt;/p>
&lt;p>第一个是挂载配置下的&lt;code>映射的本地目录&lt;/code>，这个是把阿里云盘的数据下载下来的目录，需要把他挂载在一个比较大的存储路径。&lt;/p>
&lt;p>第二个是备份模式：&lt;code>ALIYUNPAN_SYNC_MOD&lt;/code>，我这里是把云盘文件下载到本地，所以模式是&lt;code>download&lt;/code>。&lt;/p>
&lt;p>第三个是网盘：&lt;code>ALIYUNPAN_SYNC_DRIVE&lt;/code>，阿里云盘分为备份盘和资源盘，我这里大部分转存的文件都是放在资源盘，所以这里配置&lt;code>resource&lt;/code>。&lt;/p>
&lt;p>第四个是备份目标目录：&lt;code>ALIYUNPAN_PAN_DIR&lt;/code>，这个配置就是当前容器需要下载的目录，上边指定了需要下载资源盘的文件，但是肯定不能整个资源盘都下载，只需要指定特定的目录下载就行了，比如我转存的文件都是放在&lt;code>来自分享&lt;/code>目录下，我这里就配置来自分享。&lt;/p>
&lt;p>&lt;img src="https://www.iminling.com/wp-content/uploads/2024/07/9BB509B435FAFEFE2A9CE751D2D1E313.jpg"
loading="lazy"
alt="aliyunpan share"
>&lt;/p>
&lt;p>js的通知后边在讲，这个目录里边暂时可以先不放任何js文件。&lt;/p>
&lt;p>然后就可以启动docker compose文件了。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">docker compose up -d
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>此时虽然启动了容器，但是因为没有配置token，容器会一直重启，但是此时目录config目录下就会多出一个aliyun_config.json的文件，编辑文件找到&lt;code>accessToken&lt;/code>属性，把第一步生成好的token替换进去就可以了。保存文件后等待容器下一次重启或者手动重启容器就可以了。此时就可以了。&lt;/p>
&lt;h2 id="验证">验证
&lt;/h2>&lt;p>接下来就是找一个文件保存到云盘的指定要下载的目录，我是&lt;code>来自分享&lt;/code>，然后去看一下目录有没有进行下载。也可以通过查看容器的日志：&lt;/p>
&lt;pre class="corepress-code-pre">root@docker:~/images/aliyunpancli# docker compose logs -tf --tail 10
WARN[0000] /root/images/aliyunpancli/docker-compose.yaml: `version` is obsolete
aliyunpan-sync | 2024-07-06T02:52:51.522742265Z 扫描到云盘文件：/来自分享/Cover the sky.S01E61.2023.2160p.WEB.DL.H265.DDP2.0-BestWEB.mkv
aliyunpan-sync | 2024-07-06T02:52:56.282356345Z 完成全部文件的同步下载，等待下一次扫描
aliyunpan-sync | 2024-07-06T02:53:51.550419129Z 开始进行文件扫描...
aliyunpan-sync | 2024-07-06T02:53:51.756156867Z 扫描到云盘文件：/来自分享/Jade Dynasty.S02E43.2022.2160p.WEB-DL.H265.DDP2.0-BestWEB.mkv
aliyunpan-sync | 2024-07-06T02:53:51.756982180Z 扫描到云盘文件：/来自分享/Cover the sky.S01E61.2023.2160p.WEB.DL.H265.DDP2.0-BestWEB.mkv
aliyunpan-sync | 2024-07-06T02:53:56.554962070Z 下载文件：/来自分享/Jade Dynasty.S02E43.2022.2160p.WEB-DL.H265.DDP2.0-BestWEB.mkv
下载到本地:/home/app/data/Jade Dynasty.S02E43.2022.2160p.WEB-DL.H265.DDP2.0-BestWEB.mkv ↓ 773.00MB/779.46MB(99.17%) 9.64MB/s............下载完毕：/home/app/data/Jade Dynasty.S02E43.2022.2160p.WEB-DL.H265.DDP2.0-BestWEB.mkv&lt;/pre>
&lt;p>通过日志可以看出它在不停的扫描，检测到新文件就开始进行下载。&lt;/p>
&lt;h2 id="js通知">JS通知
&lt;/h2>&lt;p>在docker compose文件中，指定了js文件的目录，那么要怎么使用呢？官方也有一些具体的例子：&lt;a class="link" href="https://github.com/tickstep/aliyunpan/blob/main/docs/manual.md#JavaScript%E6%8F%92%E4%BB%B6" target="_blank" rel="noopener"
>JavaScript插件&lt;/a>，我这里需要提供一个下载完成通知的功能，保存文件后什么时候下载完成是大家比较关心的，总不能总是查看日志。&lt;/p>
&lt;p>这里要使用到的js文件是&lt;code>sync_handler.js&lt;/code>文件。文件具体的内容如下：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;span class="lnt">41
&lt;/span>&lt;span class="lnt">42
&lt;/span>&lt;span class="lnt">43
&lt;/span>&lt;span class="lnt">44
&lt;/span>&lt;span class="lnt">45
&lt;/span>&lt;span class="lnt">46
&lt;/span>&lt;span class="lnt">47
&lt;/span>&lt;span class="lnt">48
&lt;/span>&lt;span class="lnt">49
&lt;/span>&lt;span class="lnt">50
&lt;/span>&lt;span class="lnt">51
&lt;/span>&lt;span class="lnt">52
&lt;/span>&lt;span class="lnt">53
&lt;/span>&lt;span class="lnt">54
&lt;/span>&lt;span class="lnt">55
&lt;/span>&lt;span class="lnt">56
&lt;/span>&lt;span class="lnt">57
&lt;/span>&lt;span class="lnt">58
&lt;/span>&lt;span class="lnt">59
&lt;/span>&lt;span class="lnt">60
&lt;/span>&lt;span class="lnt">61
&lt;/span>&lt;span class="lnt">62
&lt;/span>&lt;span class="lnt">63
&lt;/span>&lt;span class="lnt">64
&lt;/span>&lt;span class="lnt">65
&lt;/span>&lt;span class="lnt">66
&lt;/span>&lt;span class="lnt">67
&lt;/span>&lt;span class="lnt">68
&lt;/span>&lt;span class="lnt">69
&lt;/span>&lt;span class="lnt">70
&lt;/span>&lt;span class="lnt">71
&lt;/span>&lt;span class="lnt">72
&lt;/span>&lt;span class="lnt">73
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="o">//&lt;/span> &lt;span class="o">------------------------------------------------------------------------------------------&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">//&lt;/span> &lt;span class="err">函数说明：同步备份&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="err">同步文件后的回调函数&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">//&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">//&lt;/span> &lt;span class="err">参数说明&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">//&lt;/span> &lt;span class="n">context&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="err">当前调用的上下文信息&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">//&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">//&lt;/span> &lt;span class="s2">&amp;#34;appName&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;aliyunpan&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">//&lt;/span> &lt;span class="s2">&amp;#34;version&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;v0.1.3&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">//&lt;/span> &lt;span class="s2">&amp;#34;userId&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;11001d48564f43b3bc5662874f04bb11&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">//&lt;/span> &lt;span class="s2">&amp;#34;nickname&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;tickstep&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">//&lt;/span> &lt;span class="s2">&amp;#34;fileDriveId&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;19519111&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">//&lt;/span> &lt;span class="s2">&amp;#34;albumDriveId&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;29519122&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">//&lt;/span> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">//&lt;/span> &lt;span class="n">appName&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="err">应用名称，当前固定为&lt;/span>&lt;span class="n">aliyunpan&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">//&lt;/span> &lt;span class="n">version&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="err">版本号&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">//&lt;/span> &lt;span class="n">userId&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="err">当前登录用户的&lt;/span>&lt;span class="n">ID&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">//&lt;/span> &lt;span class="n">nickname&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="err">用户昵称&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">//&lt;/span> &lt;span class="n">fileDriveId&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="err">用户文件网盘&lt;/span>&lt;span class="n">ID&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">//&lt;/span> &lt;span class="n">albumDriveId&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="err">用户相册网盘&lt;/span>&lt;span class="n">ID&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">//&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">//&lt;/span> &lt;span class="n">params&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="err">同步文件后的参数&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">//&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">//&lt;/span> &lt;span class="s2">&amp;#34;action&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;upload&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">//&lt;/span> &lt;span class="s2">&amp;#34;actionResult&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;success&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">//&lt;/span> &lt;span class="s2">&amp;#34;driveId&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;19519221&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">//&lt;/span> &lt;span class="s2">&amp;#34;fileName&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;1.txt&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">//&lt;/span> &lt;span class="s2">&amp;#34;filePath&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;D:/goprojects/dev/upload/1.txt&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">//&lt;/span> &lt;span class="s2">&amp;#34;fileSha1&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;294C8F24C56042710813E95C55A0B018299BA9A7&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">//&lt;/span> &lt;span class="s2">&amp;#34;fileSize&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;28077&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">//&lt;/span> &lt;span class="s2">&amp;#34;fileType&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;file&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">//&lt;/span> &lt;span class="s2">&amp;#34;fileUpdatedAt&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;2022-03-04 15:19:47&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">//&lt;/span> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">//&lt;/span> &lt;span class="n">action&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="err">同步动作，&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">//&lt;/span> &lt;span class="n">download&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="err">下载文件，&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">//&lt;/span> &lt;span class="n">upload&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="err">上传文件，&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">//&lt;/span> &lt;span class="n">delete_local&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="err">删除本地文件，&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">//&lt;/span> &lt;span class="n">delete_pan&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="err">删除云盘文件，&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">//&lt;/span> &lt;span class="n">create_local_folder&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="err">创建本地文件夹，&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">//&lt;/span> &lt;span class="n">create_pan_folder&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="err">创建云盘文件夹&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">//&lt;/span> &lt;span class="n">actionResult&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="err">同步结果，&lt;/span>&lt;span class="n">success&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="err">成功，&lt;/span>&lt;span class="n">fail&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="err">失败&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">//&lt;/span> &lt;span class="n">driveId&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="err">网盘&lt;/span>&lt;span class="n">ID&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">//&lt;/span> &lt;span class="n">fileName&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="err">文件名称&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">//&lt;/span> &lt;span class="n">filePath&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="err">文件完整路径&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">//&lt;/span> &lt;span class="n">fileSha1&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="err">文件&lt;/span>&lt;span class="n">SHA1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">//&lt;/span> &lt;span class="n">fileSize&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="err">文件大小，单位&lt;/span>&lt;span class="n">B&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">//&lt;/span> &lt;span class="n">fileType&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="err">文件类型，&lt;/span>&lt;span class="n">file&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="err">文件，&lt;/span>&lt;span class="n">folder&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="err">文件夹&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">//&lt;/span> &lt;span class="n">fileUpdatedAt&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="err">文件修改时间&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">//&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">//&lt;/span> &lt;span class="err">返回值说明&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">//&lt;/span> &lt;span class="err">（无）&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">//&lt;/span> &lt;span class="o">------------------------------------------------------------------------------------------&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">function&lt;/span> &lt;span class="n">syncFileFinishCallback&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">context&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">params&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">console&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">log&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">params&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">var&lt;/span> &lt;span class="n">header&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;User-Agent&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/100.0.4896.88 Safari/537.36&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;Content-Type&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;application/json&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;Accept&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;application/json&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">};&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">try&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">var&lt;/span> &lt;span class="n">text&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s2">&amp;#34;文件名：&amp;#34;&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="n">params&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s2">&amp;#34;fileName&amp;#34;&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="s2">&amp;#34; 同步完成, 同步结果: &amp;#34;&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="n">params&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s2">&amp;#34;actionResult&amp;#34;&lt;/span>&lt;span class="p">];&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">params&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s2">&amp;#34;actionResult&amp;#34;&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">===&lt;/span> &lt;span class="s2">&amp;#34;fail&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">var&lt;/span> &lt;span class="n">reqData&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;chat_id&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;这里是自己的id&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;text&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">text&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">};&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">var&lt;/span> &lt;span class="n">r&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">PluginUtil&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">Http&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">post&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">header&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;https://api.telegram.org/{这里替换具体的电报机器人token}/sendMessage&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">JSON&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">stringify&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">reqData&lt;/span>&lt;span class="p">));&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span> &lt;span class="n">catch&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">e&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">e&lt;/span> &lt;span class="o">!==&lt;/span> &lt;span class="s2">&amp;#34;Error&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">throw&lt;/span> &lt;span class="n">e&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>怎么创建电报机器人以及获取自己的id这里就不再说了，大家可以网上搜索一下，如果后续时间充裕，我也会详细教大家如何创建机器人和查看自己的id。&lt;/p>
&lt;p>text就是通知的内容，来看一下最终的通知效果：&lt;/p>
&lt;p>&lt;img src="https://www.iminling.com/wp-content/uploads/2024/07/05B5E84F322C5B0AB5CFF6A562CEADFC.jpg"
loading="lazy"
alt="aliyunpan sync notification"
>&lt;/p></description></item><item><title>搭建属于自己的影视小站：小雅Alist安装及使用</title><link>https://konghanghang.github.io/iminling-pages/2024/how-to-build-xiaoya-alist-and-use/</link><pubDate>Sat, 20 Apr 2024 06:39:56 +0000</pubDate><guid>https://konghanghang.github.io/iminling-pages/2024/how-to-build-xiaoya-alist-and-use/</guid><description>&lt;p>之前一直在使用其他的影视站去看一些电影，这些影视站基本网速都比较慢，画质也都一般，观看体验也不怎么好，这里顺便也分享一下我一直使用的影视站：&lt;a class="link" href="https://www.549.tv/" target="_blank" rel="noopener"
>影视森林&lt;/a>，该站整理了一些比较不错的影视站。偶然的机会下了解到了小雅(xiaoya)Alist，搭配阿里云盘简直不要太爽，作者也在一直更新资源，非常推荐自己搭建，下边就简单介绍一下我的搭建过程以及一些使用。&lt;/p>
&lt;h2 id="准备工作">准备工作
&lt;/h2>&lt;p>在进行安装前需要先获取三个东西：token,open token以及folder id,下边介绍一下如何获取这几个信息。另外需要在机器上安装docker，因为小雅Alist是使用docker镜像来安装的，如果本机还没有安装docker,可以参考我的文章：&lt;a class="link" href="https://www.iminling.com/2023/06/10/164.html" title="docker安装"
target="_blank" rel="noopener"
>docker安装&lt;/a> 来安装docker。&lt;/p>
&lt;h3 id="token">token
&lt;/h3>&lt;p>打开网站：&lt;a class="link" href="https://aliyuntoken.vercel.app/" target="_blank" rel="noopener"
>https://aliyuntoken.vercel.app/&lt;/a>，会出现二维码，使用手机端的阿里云盘扫描就可以获取到token。先记录下。&lt;/p>
&lt;h3 id="open-token">open token
&lt;/h3>&lt;p>打开网站：&lt;a class="link" href="https://alist.nn.ci/tool/aliyundrive/request.html" target="_blank" rel="noopener"
>Get Aliyundrive Refresh Token&lt;/a>，首先点击&lt;code>Scan QrCode&lt;/code>获取二维码，然后使用手机端阿里云盘扫描，扫描完成后再点击&lt;code>I have scan&lt;/code> 来获取&lt;code>refresh token&lt;/code>。同时记录下这个token。&lt;/p>
&lt;p>&lt;img src="https://www.iminling.com/wp-content/uploads/2024/04/56ECF1D6D2882D49983EC43FFEEB4BC7.png"
loading="lazy"
alt="aliyun refresh token"
>&lt;/p>
&lt;h3 id="folder-id">folder id
&lt;/h3>&lt;p>打开小雅的分享地址：&lt;a class="link" href="https://www.alipan.com/s/rP9gP3h9asE" target="_blank" rel="noopener"
>https://www.alipan.com/s/rP9gP3h9asE&lt;/a>，将里边的内容转存到自己的网盘下，选择资源库。&lt;/p>
&lt;p>&lt;img src="https://www.iminling.com/wp-content/uploads/2024/04/F06E1DE419C12BD3D4F5A0E45E14236C.png"
loading="lazy"
alt="aliyun share save"
>&lt;/p>
&lt;p>然后进入到自己的&lt;a class="link" href="https://www.alipan.com/" target="_blank" rel="noopener"
>阿里云盘&lt;/a>，打开刚才转存的目录，看地址栏，最后那一串字符串就是需要的folder id.记录改folder id.&lt;/p>
&lt;p>&lt;img src="https://www.iminling.com/wp-content/uploads/2024/04/4C4D087E902BDF21AA67098CB4264DE1.png"
loading="lazy"
alt="xiaoya folder id"
>&lt;/p>
&lt;p>经过上边几步，已经准备好了所需要的三个必须信息，下边就开始安装小雅Alist。&lt;/p>
&lt;h2 id="小雅alist安装">小雅Alist安装
&lt;/h2>&lt;p>安装有几种方式，小雅也有提供一键安装脚本，比较方便，下边我介绍一下几种安装方式。&lt;/p>
&lt;h3 id="一键脚本">一键脚本
&lt;/h3>&lt;p>这种方式最简单，在获取了上边的信息后，就可以直接在vps或者自己的电脑上进行安装，打开命令窗口(终端)执行一键安装脚本：bash -c &amp;ldquo;$(curl &lt;a class="link" href="http://docker.xiaoya.pro/update_new.sh%29%22" target="_blank" rel="noopener"
>http://docker.xiaoya.pro/update_new.sh)"&lt;/a>，执行后会提示输入token（32位）、open Token也就是刚才的refresh Token(335位)以及folder id(40位)，输入完成后就开始了安装，等待结束就可以了。通过docker 命令&lt;code>docker ps&lt;/code>来查看安装情况,看是否有一个容器名称为&lt;code>xiaoya&lt;/code>,存在就说明安装成功。&lt;/p>
&lt;p>一键脚本安装的小雅默认配置文件是在&lt;code>/etc/xiaoya&lt;/code>目录下，后续的配置文件都需要往这个文件下配置。&lt;/p>
&lt;h3 id="docker命令">docker命令
&lt;/h3>&lt;p>上边介绍了一键脚本，本质上也是使用docker命令来安装的，如果我们想要自己控制配置放在什么地址，可以把脚本下载下来自行修改，或者来进行docker的配置安装。&lt;/p>
&lt;p>比如我想把配置文件放在&lt;code>/data/xiaoya&lt;/code>下，那么我需要在&lt;code>data/xiaoya&lt;/code>目录下先新建三个文件:&lt;/p>
&lt;ol>
&lt;li>&lt;code>mytoken.txt&lt;/code>：把信息准备中的token字符串放在这个文件里。&lt;/li>
&lt;li>&lt;code>myopentoken.txt&lt;/code>：把信息准备中的refresh Token字符串放在这个文件里&lt;/li>
&lt;li>
&lt;div>
&lt;div>
&lt;code>temp_transfer_folder_id.txt&lt;/code>：把folder id字符串放在这个文件里。
&lt;/div>
&lt;/li>
&lt;/ol>
&lt;pre>&lt;code>&amp;lt;/div&amp;gt;
&amp;lt;div&amp;gt;
&amp;lt;/div&amp;gt;
&lt;/code>&lt;/pre>
&lt;p>此时准备工作就完成了，可以来使用命令来安装小雅了：&lt;/p>
&lt;div>
&lt;div>
&lt;code>docker run -d --network=host -v /data/xiaoya:/data --restart=always --name=xiaoya xiaoyaliu/alist:hostmode&lt;/code>,等待安装完成，同样通过&lt;code>docker ps&lt;/code>来查看是否启动成功，后续所有的配置文件都放在&lt;code>/data/xiaoya&lt;/code>目录下。
&lt;/div>
&lt;h3>
docker compose安装
&lt;/h3>
&lt;p>
这种是我最常用的方式，容器的配置都放在compose文件中，方便管理。和docker安装差不多，也是先需要将三个文件创建出来，目录结构如下：
&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">root@docker:~/xiaoya# tree -l
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">├── data
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">│ ├── docker_address.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">│ ├── myopentoken.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">│ ├── mytoken.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">│ └── temp_transfer_folder_id.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">└── docker-compose.yaml
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>
docker-compose.yaml文件内容如下：
&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">root@docker:~/xiaoya# cat docker-compose.yaml
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">version: &amp;#39;3.9&amp;#39;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">services:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> xiaoya:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> image: xiaoyaliu/alist:latest
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> container_name: xiaoya
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> env_file:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - .env
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> restart: unless-stopped
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ports:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - 5678:80
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - 2345:2345
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - 2346:2346
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> volumes:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - ./data:/data
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> environment:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - TZ=Asia/Shanghai
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>
然后在&lt;code>~/xiaoya&lt;/code>目录下执行 &lt;code>docker compose up -d&lt;/code>启动就可以了。
&lt;/p>
&lt;/div>
&lt;p>经过上边的安装已经可以通过你的&lt;code>机器ip:5678&lt;/code>来访问了。&lt;/p>
&lt;p>&lt;img src="https://www.iminling.com/wp-content/uploads/2024/04/B00FCE6AB9BD68DF013650341B6BDF55.png"
loading="lazy"
alt="alist index"
>&lt;/p>
&lt;div>
&lt;h2>
播放
&lt;/h2>
&lt;p>
经过上边安装默认情况下已经可以正常使用了，在网页端找到自己想观看的电影，直接在网页端观看，或者在视频播放器下边的按钮里选择自己本地已安装的程序打开进行播放,例如下边有iina,VLC等播放器，自己在本地安装就可以了。
&lt;/p>
&lt;p>
![alist play](https://www.iminling.com/wp-content/uploads/2024/04/2B446AD735475942885308A513786C76.png)
&lt;/p>
&lt;p>
也可以在小雅Alist中找到对应的安装包，也提供了很多播放器的安装包：
&lt;/p>
&lt;p>
![alist software](https://www.iminling.com/wp-content/uploads/2024/04/A5DB9AE8F4DCCC40B6E7D4CF0CD6BAEA.png)
&lt;/p>
&lt;h3>
安卓手机
&lt;/h3>
&lt;p>
想要在安卓手机上使用alist,我是使用tvbox来观看的，在小雅Alist提供的安装包里也是有tvbox的，需要在配置文件目录新建一个&lt;code>docker_address.txt&lt;/code>文件，里边填写http://xxxxx:5678，网址最后不需要/, xxx替换为自己的vps的ip，或者搭建机器的内网ip。
&lt;/p>
&lt;p>
安卓手机正常安装后进行配置：http://xxxxx:5678/tvbox/my.json。
&lt;/p>
&lt;p>
![tvbox setting](https://www.iminling.com/wp-content/uploads/2024/04/8C14BC01703C12A9BAA1DB2B9F3702D2.png)
&lt;/p>
&lt;p>
如果同时有内网以及外网地址，那么想要在公网访问，则需要再多建一个&lt;code>docker_address_ext.txt&lt;/code>,里边需要填写公网的&lt;code>ip:端口&lt;/code>,然后在tvbox中进行配置:http://xxxxx:5678/tvbox/my_ext.json就可以了。
&lt;/p>
&lt;h3>
电视端
&lt;/h3>
&lt;p>
其实和安卓端是一样的，安装tvbox(安装包也是在小雅Alist中获取)，按照安卓的配置方式，进行配置后就可以观看了。
&lt;/p>
&lt;h2>
配置
&lt;/h2>
&lt;h3>
登录配置
&lt;/h3>
&lt;p>
如果你搭建的机器是公网的，又不想别人随便使用，可以通过配置，需要使用账号和密码来登录，需要在配置文件目录添加两个文件:&lt;code>guestlogin.txt&lt;/code>,和&lt;code>guestpass.txt&lt;/code>两个文件，&lt;code>guestlogin.txt&lt;/code>控制Alist网页端需要登录，只是一个空文件就可以了，&lt;code>guestpass.txt&lt;/code>里边内容是登录密码，这样子访问你的Alist就需要账号和密码了，账号是：dav，密码是&lt;code>guestpass.txt&lt;/code>中的内容。
&lt;/p>
&lt;/div>
&lt;p>其他配置暂时也没有使用到，后续有使用到再进行更新，祝大家都能顺利安装成功。&lt;/p></description></item></channel></rss>